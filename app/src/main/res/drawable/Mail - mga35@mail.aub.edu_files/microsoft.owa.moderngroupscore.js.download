try { window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.moderngroupscore.js'] = (new Date()).getTime();
var IGroupFilesModuleContentViewModel=function(){};IGroupFilesModuleContentViewModel.registerInterface("IGroupFilesModuleContentViewModel");Type.registerNamespace("_xc");_xc.i=function(n,t,i,r,u,f,e,o,s,h){_xc.i.initializeBase(this,[n,t,i,r,u,f,o,null,e,h,-1,!1]);this.s.explicitLogonUser=n.a.Mailbox.EmailAddress;this.bt=s;this.bs=!!h};_xc.i.prototype={bt:null,by:function(){return this.bt},bn:function(n){return n?_xc.i.b:_xc.i.a},bs:!1};function ModernGroupsCoreComponent(){}ModernGroupsCoreComponent.$$cctor=function(){_a.t.a().a(ModernGroupsCoreComponent)};ModernGroupsCoreComponent.prototype={b:function(n,t,i){n.e(_xc.q).b(_h.cI).a();var f=this;n.b(IGroupConversationItemQueryTableFactory,function(){return new _xc.u(n.a(_a.f))}).a();var u=this;n.b(IGroupConversationDataPrefetcher,function(){return new _xc.g(n.a(IGroupConversationItemPartsFactory),n.a(_h.cI),n.a(IGroupConversationItemQueryTableFactory))}).a();var r=this;n.b(IGroupFilesModuleViewModel,function(){return new _xc.j(n.a(_y.a),n.a(_j.j),n.a(_a.bp),n.a(_bc.a),n.a(_y.s),n.c(IGroupFilesModuleContentViewModel),n.c(_xs.g),n.a(_a.f))}).a();_a.c.m("NavigateFromMeToWeSpace")},a:function(){return null}};_xc.m=function(){};_xc.m.registerInterface("_xc.m");_xc.w=function(){};_xc.w.registerInterface("_xc.w");_xc.s=function(n){this.c=n};_xc.s.prototype={c:null,b:function(n){var i=n;var t="";i==="previously-loaded"&&(this.c&&this.c.a().bu().Enabled?t=_nbs.a.Ld:this.c&&this.c.a().bv().Enabled&&(t=_nbs.a.BP));return new _xz.a(t,i,!!this.c&&this.c.a().bv().Enabled)},a:function(){return!1}};_xc.t=function(n,t){var i=this;_xc.t.initializeBase(this,[new _xc.s(t),function(n){return n}]);this.d=n};_xc.t.prototype={d:null,i:function(n){var r=n;var i=this.d.et(r);var u=i?"previously-loaded":"newly-loaded";var t=this.c.c(u);i||t.b(!0);return t}};_xc.u=function(n){this.d=Function.createDelegate(this,this.b);this.c=n};_xc.u.prototype={c:null,b:function(n,t,i){return this.c&&this.c.a().P().Enabled?new _xc.n(n,t,i,this.c):new _xc.h(n,t,i,this.c)}};_xc.d=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.ke=Function.createDelegate(this,this.pe);this.pa=Function.createDelegate(this,this.sl);this.pb=Function.createDelegate(this,this.ss);this.mD=Function.createDelegate(this,this.sc);this.mE=Function.createDelegate(this,this.sg);_xc.d.resolveInheritance();this.ds=this.st;_xc.d.initializeBase(this,[n,t,i,r,u,null,f,o,null,e,null,h,null,null,null,c,null,null,null,null,null,null,a,null,v,!1]);this.gz=!0;this.bl(this.gf());this.cr(!0);this.el(_xc.d.a);this.mM=s;this.mI=new _y.dS(n.a());this.eA.b(_mgn.D,this.mE);this.mK=l;this.mL=a;this.hJ=!1;this.ha=new _xc.k(this.eA,r,_mgs.X.X,_mgs.X.BV);this.ha.apcl("IsClosed",this.mD)};_xc.d.d=function(n,t){var i=!0;return _xc.d.b(i)};_xc.d.b=function(n){return n?"GroupConversationFeedView":"GroupConversationListView"};_xc.d.prototype={mI:null,mM:null,mL:null,gz:!1,hc:null,kg:null,iP:null,mK:null,hJ:!1,kh:null,mJ:!1,fG:null,hI:0,fV:null,du:function(){var n=[];Array.add(n,new _fm.c(_u.R.N,null,this.iC));Array.add(n,new _fm.c(_u.R.UE,null,this.ig));Array.add(n,new _fm.i);Array.add(n,new _fm.c(_u.R.Ex,null,this.mF));if(this.fG){this.fG.p.g();this.fG.p.m(n)}else this.fG=new _fm.e(n)},sa:function(n){if(!this.fV&&n&&n.b()>0){this.fV=new _y.bB(_u.R.NM,null,this.pb,null,n,_g.ba.a,!1,null,null,!1);this.fV.u(!0);if(this.fG&&this.fG.p){this.fG.p.a(this.fV);this.fG.t=this.pa}}},sk:function(){if(this.fG&&this.fG.p&&this.fV){this.fG.p.p(this.fV,!0);this.fV=null}},mF:null,dv:function(n){this.mF=n;return n},so:function(n){if(this.gz!==n){this.gz=n;this.eB("IsFeedView")}return n},cr:function(n){this.mJ=n;this.eB("FocusItemOnSelect");return n},fz:function(){return this.hc},bt:function(n){if(this.hc!==n){this.hc=n;this.pf(n);if(n){this.F(null);this.en(_g.y.f(this.hc),null);this.sk();this.mG=_mr.S.a(this.eQ,this.hc.bD.SmtpAddress)}else this.en(null,null);this.gf()&&this.eB("ShowNewConversationLabel");this.eB("RefreshButtonAriaLabel");this.eB("ModernGroup")}return n},ss:function(n){var i=this.ey;var t=new _h.co;t.l(i.bD.FolderId);t.g([i]);t.p=0;t.s=n;_a.g.a.a(t)},sl:function(){this.fV&&this.fV.bi()},hb:function(){return this.eu.a().x.length},sf:function(n){this.iO=!1;if(!this.fq)return _nbs.a.ix;if(this.fq===1)return _nbs.a.jJ;var t;if(this.fq>99){t="99+";this.iO=!0}else if(n||this.hb()>0&&!(this.hb()%this.gk())&&this.hb()===this.fq){t=this.fq+"+";this.iO=!0}else t=this.fq.toString();return String.format(_nbs.a.pW,t)},iO:!1,fq:0,sp:function(n){if(this.kh!==n){this.kh=n;this.eB("NewConversationLabelText")}return n},fX:function(n){return this.gm&&this.gf()?new _xc.t(this,this.eQ):null},hp:function(){var i=null;if(this.ey){var n=this.ey;var t=new _g.i;t.cX(n.bD.ConversationTopic);if(n.a()&&n.a().b()>0){t.cb(n.a().a(0));i=t}}return i},oB:function(n){var i;var u=_a.c.b(_a.a.cI,"ReadingPanePopOut",!0,(i=new _a.K,i.a=!0,i));u.n(_xc.d.c);var f={};f.ItemID=n.bD.ItemId.Id;var t=new _y.n(!0);t.d(this.ew.b);t.f(this.fZ());t.b(this.gc);t.c(!1);t.a(n);t.e(_h.n.a(this.j()));t.i(this.ie);t.by(u);this.kf()&&t.j(this.kf().bD.SmtpAddress);var r=_h.a.a(n.bD.ParentFolderId);r&&t.g(r.bD.DisplayName);t.h(this.fy);this.eX.g(IModernItemReadingPaneViewModelPopOutFactory,null,f,_bc.d.a(),t,!1)},kf:function(){return this.kg},pf:function(n){if(this.kg!==n){this.kg=n;this.eB("ModernGroupFromSelectedConversation")}return n},iN:!1,sd:function(){return this.mI.j(this.hc)},dt:function(){return this.hG()?!this.pc():!this.C()||this.C()===1},hH:function(){return this.eQ.a().bu().Enabled&&!this.hG()},iQ:function(){return this.eQ.a().bv().Enabled&&!this.hG()},gf:function(){return this.hH()||this.iQ()},pd:function(){return!this.fz().isMember&&(this.fz().b===1||this.fz().b===2)},se:function(){return this.hH()&&!this.pd()||this.iQ()&&this.fq>0&&!this.pd()},pc:function(){if(this.hI===2||this.hI===3)return!0;if(this.ev&&IGroupSearchViewModel.isInstanceOfType(this.ev)){var n=this.ev;return n.d()}return!1},hG:function(){return!!this.ev&&this.ev.e()||!!this.hI},dw:function(n){if(this.hI!==n){this.hI=n;this.eF("IsCrossGroupSearch","IsInSearchMode")}return n},mH:!1,bu:function(n){this.mH=n;return n},dx:function(n){if(this.hJ!==n){this.hJ=n;this.eB("ShowSuggestPublicGroupsSearchBar")}return n},ha:null,gk:function(){return this.gz?15:_lv.b.prototype.gk.call(this)},lo:function(){return"ModernGroupConversationSearch"},mG:!1,et:function(n){n.H=n.h().p().b(this.fz().p().p())<=0;return n.H},cq:function(n,t){n===3&&this.hJ&&this.dr();this.fl=!1;this.iF(t);this.ge(!1);this.mj()},dq:function(){this.dw(0)},dr:function(){this.dx(!1)},mR:function(n){return new _xc.c(n,this.fz(),this,this.eX,this.eQ,this.mG,this.mL)},nS:function(){return this.gW},mS:function(n,t){var r=!!t&&!_j.h.a(t.h);this.so(!r);var i=_xc.d.b(this.gz);return new _xc.l(n,t,this.eY,this.gz,i,this.fz())},kn:function(n){var t;var r,i;var u=(i=_h.c.v(n,this.iT,this.mM,this.mK.d,r={val:t}),t=r.val,i);this.fl=t;return u},oA:function(n,t){this.eB("GroupTable");this.ki(!1)},eE:function(){this.eA.c(_mgn.D,this.mE);this.ha&&this.ha.rpcl("IsClosed",this.mD);this.ev&&this.ev.u("InSearchMode",this.ke);_lv.b.prototype.eE.call(this)},kp:function(n,t,i,r){this.fJ?n.L(this.iP,t,i,r):_lv.h.prototype.kp.call(this,n,t,i,r)},nY:function(n,t,i,r,u){var f=this.ev.b();return this.ev.h().e(n,t,i,r,!0,u,[f.c()],f.d()?10:0,f.a())},oS:function(){return this.eu.i()||this.iN},oz:function(){this.eB("ShouldShowCompose");if(IGroupSearchViewModel.isInstanceOfType(this.ev)){var n=this.ev;n.z()}},me:function(n){this.mH||_lv.b.prototype.me.call(this,n)},ou:function(n){n&&_xt.d.isInstanceOfType(n)&&this.ev&&this.sj(n)},sj:function(n){this.eQ.a().es().Enabled&&!n.f()&&this.si(n)},si:function(n){var r=this.ev.b();var t=this.ev.h().a(n.c(),n.a(),n.b(),null,null,!0,n.e(),[3],1,r.a());if(t){var i=this;t.e(function(t,r){i.sh(t,n.d(),r,3,1)});t.a()}},sg:function(n){if(this.eu){var t=this.eu.k(n.a);if(t){this.F(t);_mgn.h.a()}else{this.cs(n.a,n.b);this.eu.L(n.a,new _h.m(0,this.gk()),200,null)}}},sh:function(n,t,i,r,u){if(this.hG()&&u===1&&this.eQ.a().es().Enabled&&r===3&&n&&n.b()>=1){this.ha.v(n,t,i,i,r);this.dx(!0)}},sc:function(n,t){this.dr()},lZ:function(){this.ev&&this.ev.u("InSearchMode",this.ke)},mb:function(){this.ev&&this.ev.q("InSearchMode",this.ke);this.eB("ShowNewConversationLabel");this.bl(this.gf());this.eB(_lv.b.d);this.pe(null,"IsInSearchMode")},ep:function(){return this.gf()},ma:function(n,t){_lv.b.prototype.ma.call(this,n,t);t.c===2&&this.sm(t.b);this.sn();this.gf()&&(this.hH()&&this.iO&&(!t.c||t.c===2||t.c===1)&&t.f===4?this.ki(!0):this.ki(!1))},ki:function(n){if(this.gf()&&this.eu&&this.eu.a()){var i;if(this.fq>0&&this.fq<=this.hb()&&!this.et(this.eu.a().x[this.fq-1]))i=this.fq;else{i=0;this.fq=0}for(var t=i;t<this.hb();t++)if(this.et(this.eu.a().x[t]))break;else this.fq++;if(this.hH()){this.sp(this.sf(n));this.eB("UnseenConversationCount")}this.iQ()&&this.eB("ShowNewConversationLabel")}},sq:function(){var n=this;_j.m.a().a(_a.a.h,"ShowStartNewConvGroupOobe",function(){var t;n.eA.a(IGroupsOobeEvent,(t=new _mgn.p,t.b=1,t))},1e3)},sr:function(){if(this.fJ){var n=null;if(this.eu&&this.hb()>0){n=this.eu.k(this.iP);if(n){this.bo(1);this.Z(0);this.jW(n);this.Z(1);this.bo(0)}}if(n||this.eu&&!this.eu.d()){this.sb();_mgn.h.a()}}},oi:function(n,t){return this.fz().bD.DisplayName},lL:function(n,t){_lv.b.prototype.lL.call(this,n,t);this.sr()},fF:function(){_lv.h.prototype.fF.call(this);if(this.eQ.a().n().Enabled&&this.ey){var i=this.ey;var n=i.bD.FolderId;if(i){var r=this;this.hq.a(function(t){t.t(i,n,r.fr())})}if(n&&n.a.Mailbox.EmailAddress){var t=_g.y.c(n.a.Mailbox.EmailAddress);if(this.kf()&&t.bD.SmtpAddress!==this.kf().bD.SmtpAddress){this.pf(t);this.eA.a(_y.ds,new _y.ds(t))}}}this.sq()},sb:function(){this.fJ=!1;this.iP=null;this.gI=null},cs:function(n,t){this.fJ=!!n;this.iP=n;this.gI=t},oy:function(n){this.C()===1&&this.eu&&this.hb()>0&&this.dh(0)},sm:function(n){if(this.ey&&!this.ey.bD.IsDeepLinkedConversation)for(var i=n,u=i.length,t=0;t<u;++t){var r=i[t];if(this.ey===r){this.F(null);break}}},sn:function(){var t=this.ey;if(this.ey&&this.iN&&t.bD.IsDeepLinkedConversation){var n=this.eu.k(t.bD.ConversationId.Id);if(n){this.bo(1);this.Z(0);this.F(n);this.Z(1);this.bo(0)}}!this.ey&&this.eu.i()&&this.mj()},pe:function(n,t){this.eF("IsInSearchMode","IsCrossGroupSearch")}};_xc.c=function(n,t,i,r,u,f,e){this.bU=Function.createDelegate(this,this.dM);this.bT=Function.createDelegate(this,this.dL);this.bS=Function.createDelegate(this,this.dK);this.bR=Function.createDelegate(this,this.dJ);_xc.c.initializeBase(this,[n,i,r,u,e]);this.l.apcl("LastDeliveryTime",this.bR);this.l.apcl("RecentReplys",this.bS);this.l.b()&&this.l.b().apcl("LikeCount",this.bT);this.k&&this.k.fz()&&this.k.fz().unseenData&&this.k.fz().unseenData.apcl("LastVisitedTime",this.bU);this.t=new _y.dS(r.a());t&&(n.Q=t.bD.SmtpAddress);this.bZ=f};_xc.c.b=function(n,t){return!n||!n.Mailbox||!n.Mailbox.EmailAddress||!t||!t.Mailbox||!t.Mailbox.EmailAddress?!1:n.Mailbox.EmailAddress.toLowerCase()===t.Mailbox.EmailAddress.toLowerCase()};_xc.c.prototype={t:null,bi:null,bx:null,bZ:!1,bw:function(){this.bi||this.cB(_xc.c.a.b(this.l,this.cz()).d());return this.bi},cB:function(n){if(this.bi!==n){this.bi=n;this.eB("UniqueSenders")}return n},K:function(){return this.l.x()&&this.l.x().b()>0?this.l.x().a(this.l.x().b()-1):this.l.b()},bY:function(){return this.K()?this.K().bD.Preview:this.l.bD.Preview},dw:function(){return this.K()===this.l.b()?!0:this.K()&&this.l.b()?_xc.c.b(this.K().bD.From,this.l.b().bD.From):!1},bV:function(){if(_g.R.isInstanceOfType(this.l.bD.FolderId)){var n=this.l.bD.FolderId;return n.a.Mailbox.Name}return null},cz:function(){this.bx||(this.bx=this.k.pc());return this.bx},cE:function(){return this.k.ev?this.cy():this.t.c(this.l)},cy:function(){return this.t.d(this.l)},cF:function(){return this.t.e(this.bV())},cG:function(){return _j.h.c(_mgs.X.CE,this.bV())},dn:function(){return this.t.f(this.l)},dG:function(){return this.t.l(this.l)},dA:function(){return this.t.k(this.K(),this.l)},dx:function(){return this.t.g(this.l)},dy:function(){return this.t.h(this.l)},dz:function(){return this.t.i(this.l)},dE:function(){return!!this.o&&!this.o.a().bb().Enabled&&this.l.bD.MessageCount>1},dC:function(){return!!this.o&&this.o.a().dz().Enabled&&!!this.l&&!!this.l.b()&&this.l.b().co()>0},dD:function(){return!!this.o&&!this.o.a().bb().Enabled},cD:function(){if(this.l.b()&&this.l.b().bD.From)return this.l.b().bD.From;else if(this.bw()&&this.bw().length>0)return this.bw()[0].a;return null},bX:function(){if(this.l.b())return this.l.b();else if(this.l.f()&&this.l.f().b()>0&&this.l.f().a(0).toLocaleLowerCase().startsWith("ipm.schedule.meeting"))return new _dg.l;return null},bW:function(){return!this.k.et(this.l)},dB:function(){return this.bZ?this.l.bD.UnreadCount>0:this.bW()},dF:function(){return this.k.gf()||this.k.hG()?!1:this.bW()},dv:function(){return!!this.o&&this.o.a().y().Enabled},cA:function(){return!!this.o&&this.o.a().cf().Enabled&&!this.o.a().bb().Enabled},eE:function(){this.l.rpcl("RecentReplys",this.bS);this.l.rpcl("LastDeliveryTime",this.bR);this.l.b()&&this.l.b().rpcl("LikeCount",this.bT);this.k&&this.k.fz()&&this.k.fz().unseenData&&this.k.fz().unseenData.rpcl("LastVisitedTime",this.bU);_lv.g.prototype.eE.call(this)},q:function(){if(this.cA()){this.bs(this.dI().i());this.bq(this.dH())}else _lv.d.prototype.q.call(this)},bO:function(n,t){this.eB("ShouldHighlightItem");_lv.g.prototype.bO.call(this,n,t)},dI:function(){var n=new _j.q;var t=3;n.d.length<t&&this.l.V()&&n.c(34);n.d.length<t&&this.l.b()&&this.l.b().co()>0&&n.c(33);n.d.length<t&&this.l.bD.HasAttachments&&n.c(2);n.d.length<t&&(this.l.bd()==="Low"||this.l.bd()==="High")&&n.c(1);return n},dH:function(){if(this.l.bD.MessageCount>1)return this.l.bD.HasIrm||this.l.bD.IsLocked?6:3;else if(this.l.bD.HasIrm||this.l.bD.IsLocked)return 5;else if(_dg.l.isInstanceOfType(this.bX()))return 13;else if(_dg.p.isInstanceOfType(this.bX()))return 17;return-1},dL:function(n,t){this.cA()?this.q():this.eB("ShowLikeCount")},dM:function(n,t){this.eF("HasUnseenMessages","ShowUnseenMarker")},dJ:function(n,t){this.eM("ReceivedTimeAriaLabel","HasUnseenMessages","ShowUnseenMarker")},dK:function(n,t){this.cB(null);this.eI(["MostRecentMessage","Preview","RepliesAriaLabel","IsRecentSenderSameAsInitialSender"])}};_xc.c.a=function(){this.c=new _j.q;this.b=new _j.q};_xc.c.a.c=function(){_xc.c.a.a||(_xc.c.a.a=new _rps.c);return _xc.c.a.a};_xc.c.a.b=function(n,t){var r=new _xc.c.a;if(n.b()){var f=_xc.c.a.c().c(n.b());r.a(n.b().bD.From,f)}n.x()&&n.x().n(function(n){var t=n;r.a(t.bD.From,null)});if(!r.b.d.length){var i;if(n.bD.SenderSMTPAddress){i=new _g.P;i.Mailbox=new _g.g;i.Mailbox.EmailAddress=n.bD.SenderSMTPAddress;n.g()&&n.g().b()>0&&(i.Mailbox.Name=n.g().a(0));r.a(i,null)}if(t){var u=n.bD.FolderId;i=new _g.P;i.Mailbox=u.a.Mailbox;r.a(i,null)}}return r};_xc.c.a.prototype={d:function(){return this.b.i()},a:function(n,t){if(n&&n.Mailbox&&(n.Mailbox.Name||n.Mailbox.EmailAddress)){var i=n.Mailbox.EmailAddress||n.Mailbox.Name;i=i.toLowerCase();if(!this.c.g(i)){this.b.c(new _xc.r(n,t));this.c.c(i)}}}};_xc.k=function(n,t,i,r){this.n=Function.createDelegate(this,this.w);this.l=Function.createDelegate(this,this.o);this.m=Function.createDelegate(this,this.u);_xc.k.initializeBase(this);this.a=null;this.h=n;this.c=t;this.i=new _j.g(this.m,_a.a.cd);this.g=new _j.g(this.l,_a.a.cd);this.j=i;this.k=r};_xc.k.prototype={a:null,i:null,g:null,h:null,j:null,k:null,c:null,f:null,e:null,b:0,d:null,v:function(n,t,i,r,u){this.a=n;this.f=t;this.e=i;this.d=r;this.b=u},s:function(){var t=0;this.b===3&&(t=1);if(this.a&&this.a.b()>=t){var n=this.a.b();return n<=20?n.toString():String.format(_mgs.X.Dj,20)}else return""},t:function(){return String.format(this.j,this.s())},q:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-ns-b")},p:function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.q,"ms-fcl-nt-b")},u:function(){if(this.a){this.c&&this.c.a(this.n);this.h.a(_xs.e,new _xs.e(this.a))}},w:function(n){this.f&&this.d&&this.e&&this.a&&this.b&&n.bN(this.f,this.d,this.e,this.a.b(),_xt.a.toString(this.b))},o:function(){this.eB("IsClosed")}};_xc.j=function(n,t,i,r,u,f,e,o){this.s=Function.createDelegate(this,this.y);this.q=Function.createDelegate(this,this.x);this.t=Function.createDelegate(this,this.o);_xc.j.initializeBase(this,[11,"GroupFiles",n,r,t,i,new _y.bb(n.a(),null,new _xc.v,o,null,t),e]);this.a=u;this.j=o;this.n=f;if(this.a){this.a.w=new _j.g(this.t,_a.a.h);o.a().eN().Enabled&&this.a.bz(this.H);this.G.b(_y.be,this.q)}this.o();this.h=new _y.y};_xc.j.prototype={n:null,a:null,j:null,b:null,h:null,z:function(n){this.b=n;this.eB("GroupFilesModuleContentViewModel");return n},N:function(){this.i&&this.a&&this.a.g.b(this.i);var n=this;this.u(function(t){t.e(n.i)});this.k().c(this.i)},S:function(){_y.eB.prototype.S.call(this);if(this.O){this.a&&this.a.g&&this.a.g.a()&&!this.i&&this.o();this.k().c(this.i)}else{this.k().d();this.b&&this.b.c()}this.O&&this.a&&this.a.v()},o:function(){this.a&&this.a.g&&this.a.g.a()&&this.g(this.a.g.a())},u:function(n){if(this.b)n&&n(this.b);else{var t=this;this.n.b(function(i){if(!t.b){t.z(i);t.h.c(t.b);t.k().a()&&t.k().a().b()&&t.b.a(t.k().a().a());t.j.a().eN().Enabled&&t.b.d(t.H);t.k().a().apcl("IsModelLoaded",t.s)}n&&n(t.b)})}},y:function(n,t){this.b.a(this.k().a().a())},x:function(n){if(n.b===11){this.a.g.d(n.a);var t=this;this.u(function(n){n.b()});n.g(this)}}};_xc.v=function(){_xc.v.initializeBase(this,[null])};_xc.v.prototype={iJ:function(){return!0}};_xc.g=function(n,t,i){this.b=n;this.d=t;this.c=i};_xc.g.prototype={d:null,b:null,c:null,a:function(n,t){var f=n.d;var c=new _xc.l(_g.y.f(f).bD.FolderId,null,_xc.g.a,!0,"GroupConversationFeedView",f);var o;var u=this.c;var h,s;var i=(s=_h.c.v(c,this.b,this.d,u.a||(u.a=Function.createDelegate(u,u.b)),h={val:o}),o=h.val,s);if(!o){var r=_a.c.b(_a.a.cK,"GroupConversationPrefetch");r.j=f.bD.SmtpAddress;t&&r.n(_xc.g.c);n.h=1;var e=null;var l=this;e=function(){if(!i.d()||i.v()){i.bm(e);if(i.x())r.k="LoadingFailed";else{n.m&&r.n(_xc.g.b);n.h=2}_a.c.a(r)}};i.bb(e);i.o(new _h.m(0,15),702,null)}}};_xc.n=function(n,t,i,r){this.fM=Function.createDelegate(this,this.he);this.dd=_a.I.a();_xc.n.initializeBase(this,[n,t,i,r]);this.dZ=i.a("GroupConversationItemQueryTable.ResetOutstandingPostsCountTimerCallback",this.fM,3e4);this.dY=t};_xc.n.prototype={dZ:null,cE:0,dY:null,bk:function(){_xc.b.l();_xc.h.prototype.bk.call(this)},fN:function(n,t,i){var r="Group_Conversation_QuickComposeReply_Delivery";this.dZ.a();if(!n.u){n.u=!0;this.cE++;n.w=_a.c.b(_a.a.w,r,!1);n.w.n(t?_xc.b.k:_xc.b.h);n.w.n(i?_xc.b.j:_xc.b.i)}},fQ:function(n){if(n.u){n.u=!1;this.hd();if(n.w){_xc.b.D(n.w,_xc.b.a(n.b(),!1,!1),n.Q);n.w=null}}},he:function(){var n=this;this.dd.d(function(n,t){_xc.b.c(2,n,!1,null)});this.fO()},fO:function(){this.cE>0&&this.ef(!0);this.fP(!this.de())},hd:function(){this.cE--;this.cE<=0&&this.fP(!0)},fP:function(n){this.dZ.b();n&&(this.dd=_a.I.a());this.cE=0},eb:function(n){if(!this.hf(n)){_xc.h.prototype.eb.call(this,n);this.de()&&this.cE>0&&this.fO()}},eg:function(n,t,i,r){if(n){if(!n.Conversation){t||_j.e.c(this.bC(),"Conversation can't be null for new posts");var f=this.k(n.ConversationId.Id);f&&(n.Conversation=f.bD)}if(n.Conversation&&t){n.Conversation.MessageCount++;r&&(n.Conversation.LastDeliveryTime=n.DateTimeReceived)}}if(r)return _xc.h.prototype.eg.call(this,n,t,i,r);var u=_xc.h.prototype.eg.call(this,n,t,i,r);if(u){this.dd.a(n.InternetMessageId,new _xc.n.a(n.Conversation.ConversationId.Id));t||this.hb(n)}return u},hb:function(n){var t=_ff.e.a(n,!0);var u=new _bc.f;t.ItemId=u.b;t.InstanceKey="INSK:"+u.a;var r=this.dY.a(200,n.Conversation.ConversationId);var i=r.m(t,null);i.m(!0);i.g(new _a.k(n.ToRecipients));_h.c.u(n.Conversation.ConversationId,this.f(),r)},hf:function(n){if(this.de())return!1;if(this.cE>0)if(n.EventType==="RowAdded"){var i=this.cY(n.Conversation.ConversationId.Id);if(i>=0&&i<this.by.x.length){var r=this.by.x[i];if(r.u){var u=this.cT;this.bR(!0);try{this.fQ(r);this.by.y(i,4);this.bs(n,!0)}finally{this.bR(u)}this.fR(r);return!0}}}else if(n.EventType==="RowModified"){var t=this.k(n.Conversation.ConversationId.Id);if(t.u&&t.bD.MessageCount<=n.Conversation.MessageCount){this.bu(n);this.fR(t);this.fQ(t);return!0}}return!1},eQ:function(n,t,i){var r=_xc.h.prototype.eQ.call(this,n,t,i);if(i)return r;r&&this.fN(r,!1,t);return r},eR:function(n,t,i){var r=_xc.h.prototype.eR.call(this,n,t,i);if(i)return r;r&&this.fN(r,!0,t);return r},bN:function(n,t){var i=this;this.dd.d(function(n,t){var r=i.k(t.a);if(r){var u=_h.d.a().a(r.bD.ConversationId.Id);u&&u.s()!==""||_h.c.m(r.bD.ConversationId,n);r.u=!1}_xc.b.c(3,n,!1,null)});this.dd=_a.I.a();_h.r.prototype.bN.call(this,n,t)},bx:function(){_xc.b.l();_xc.h.prototype.bx.call(this)},cu:function(n){_lm.e.prototype.cu.call(this,n);var t=n.G.ErrorCode;var i=n.G.ExceptionName;_j.B.a(t)||t!==500||i!=="AccessDeniedException"||(this.cn="ErrorAccessDenied")},fR:function(n){var t=this;_h.c.o(203,n,n.bD.FolderId,function(n){var r=n.r();if(r)for(var i=r,f=i.length,t=0;t<f;++t){var u=i[t];_xc.b.c(0,u,!1,null)}},this.dY)}};_xc.n.a=function(n){this.a=n};_xc.n.a.prototype={a:null};_xc.h=function(n,t,i,r){this.fS=Function.createDelegate(this,this.hv);this.cQ={};this.dg=new _j.q;_xc.h.initializeBase(this,[n,t,r]);this.ee=i.a("GroupConversationItemQueryTable.ResetOutstandingPostsCountTimerCallback",this.fS,1e4)};_xc.h.prototype={ed:!1,df:!1,ec:!1,cF:0,ee:null,ea:null,G:function(){return this.bZ.a().bo().Enabled},de:function(){return this.ed},ef:function(n){if(this.ed!==n){this.ed=n;this.bw("NeedsRefresh")}return n},bC:function(){return _a.a.cK},v:function(){return _h.r.prototype.v.call(this)&&this.by.x.length>0},cN:function(){return this.bB.j?15:_lm.e.prototype.cN.call(this)},cZ:function(){return this.bB.j?2e3:_lm.e.prototype.cZ.call(this)},fT:function(){return!!this.bB.h},eb:function(n){this.df?this.hm(n):this.bZ.a().bo().Enabled&&this.hl(n)},hl:function(n){if(n.EventType==="RowAdded"||n.EventType==="RowModified"||n.EventType==="RowDeleted"){var i=this.cC(n);this.cQ[i]=!0;if(this.cF>0){this.fU(n);return}var r=_ff.o.a(0,6e4);var t=this;_j.m.a().a(this.bC(),"GroupConversationItemQueryTable::HandleRowNotificationWhenOnBackground",function(){t.bI||t.df||t.bl()},r)}},hm:function(n){if(this.hj()&&n.EventType==="Reload"){_j.e.a(this.bC(),"HandleRowNotification: If we reach this point, it means that a thread was deleted and we need to refresh the entire table.");this.ef(!0);return}if(n.EventType==="RowAdded"||n.EventType==="RowModified"||n.EventType==="RowDeleted"){var t=this.cC(n);this.cQ[t]=!0;if(!this.de()){if(this.cF>0){this.fU(n);return}if(n.EventType==="RowAdded"){if(t in this.bY)return;if(this.hw(n))return}if(n.EventType!=="RowDeleted"||t in this.bY){if(n.EventType==="RowModified")if(t in this.bY){var i=this.cB(t);if(i>=0&&i<this.by.x.length){var f=this.by.x[i];if(f.bD.MessageCount>=n.Conversation.MessageCount)return}}else if(this.by.x.length>0){var u=this.by.x[this.by.x.length-1];var r=_a.d.b(n.Conversation.LastDeliveryTime);if(r.b(u.h())<0)return}_j.e.a(this.bC(),"HandleRowNotification: Table needs refresh.");this.ef(!0)}}}},hs:function(){if(!this.eO()){_j.e.a(this.bC(),"OnPostStarted:: Table is not updatable, ignore call. Key:{0}.",this.bB.a());return}this.bB.j&&this.ho()},eO:function(){return!this.bI&&!this.fT()&&this.df},bv:function(n,t){if(!this.eO()){_j.e.a(this.bC(),"OnMessageLike:: Table is not updatable. Key:{0}.",this.bB.a());return}if(n&&n.Conversation){var i=n.Conversation.InstanceKey;if(!(i in this.bY)){_j.e.a(this.bC(),"OnMessageLike: Conversation not found in instanceKeyCache, ignore it. InstanceKey {0}.",i);return}var u=this.cB(i);if(u<0||u>=this.by.x.length){_j.e.a(this.bC(),"OnMessageLike: Conversation not found in table, ignore it. InstanceKey: {0}.",i);return}var r=this.by.x[u];if(t){var e;(e=r.b()).cG(e.co()-1)}else{var f;(f=r.b()).cG(f.co()+1)}this.bQ(r,n.Conversation);this.cQ[i]=!0}},hr:function(n,t,i,r){if(!this.eO()){_j.e.a(this.bC(),"OnPostCompleted:: Table is not updatable, ignore call. Key:{0}.",this.bB.a());return}this.eg(n,t,i,r);this.bB.j&&this.hh()},bk:function(){this.df=!1;if(this.bB.j){this.d()&&!this.v()||this.bS||this.de()||this.hx();_h.r.prototype.bk.call(this)}},bj:function(){this.df=!0;_h.r.prototype.bj.call(this)},L:function(n,t,i,r){this.ea=n;this.o(t,i,r);this.ea=null},cH:function(n){if(_g.R.isInstanceOfType(this.f())&&this.hi()){n.a().MailboxId=this.f().Id;return new _h.I(n.a())}else return _lm.b.prototype.cH.call(this,n)},bx:function(){this.fV();_lm.b.prototype.bx.call(this)},dB:function(n,t,i){n.a||this.fV();_lm.e.prototype.dB.call(this,n,t,i)},dK:function(n,t,i,r){var u=new _xc.i(this.f(),this.r(),n,t,this.bT(),this.bF(),r,i,this.bB.o,this.ea);u.t=this.cv;return u},bW:function(n,t,i,r,u,f){r&&_lm.b.prototype.bW.call(this,n,t,i,r,u,f)},cG:function(n){},cM:function(n,t,i,r){this.ec=this.bB.j&&this.hp(n);return this.ec?this.hg(t,i,r):_lm.b.prototype.cM.call(this,n,t,i,r)},eJ:function(n,t){this.ec?this.hu(n,t):_lm.e.prototype.eJ.call(this,n,t)},hp:function(n){return n in this.cQ},hw:function(n){var t=this.cY(n.Conversation.ConversationId.Id);if(t>=0&&t<this.by.x.length){var u=this.by.x[t];var f=u.bD.InstanceKey;var i=this.bY[f];if(i){this.bY[f]=null;var r=n.Conversation.InstanceKey;u.bk(r);this.bY[r]=i;return!0}}return!1},hg:function(n,t,i){var r=new _gg.eB;r.Item=new _g.d("ConversationLastDeliveryTime");r.FieldURIOrConstant=new _g.W;var f=new _g.U;f.Value=_a.d.b(t).l(1).i();r.FieldURIOrConstant.Item=f;var e=new _g.bc(r);var u=new _g.bh("Beginning",e);u.MaxEntriesReturned=n-1;this.r()&&(this.r().f=this.bU);return this.dK(u,!1,t,i)},hu:function(n,t){for(var i=0;i<n.length;i++){var r=t.d(n[i]);if(!(r in this.bY))break;Array.removeAt(n,i);i--}},fV:function(){this.cQ={};this.ef(!1);this.dg.f();this.eP()},eg:function(n,t,i,r){if(this.bI){_j.e.a(this.bC(),"OnPostCompleted:: Table already disposed, ignore call. Key:{0}.",this.bB.a());return!1}if(this.fT()){_j.e.a(this.bC(),"OnPostCompleted:: Table in Search View, ignore call. Key:{0}.",this.bB.a());return!1}if(n&&n.Conversation){var u=null;u=t?this.eR(n.Conversation,i,r):this.eQ(n.Conversation,i,r);return!!u}return!1},ht:function(){for(var n=0;n<this.dg.d.length;n++){var t=this.dg.d[n];this.eb(t)}this.dg.f()},fU:function(n){this.dg.c(n)},eQ:function(n,t,i){var u=n.InstanceKey;if(u in this.bY){_j.e.a(this.bC(),"UpdateTableWithQuickComposeReponse: Conversation already in table, ignore it. InstanceKey {0}.",u);return null}var r=this.bG(n);this.by.B(0,r,4);this.bp(this.bE+1);return r},eR:function(n,t,i){var u=n.InstanceKey;if(!(u in this.bY)){_j.e.a(this.bC(),"UpdateTableWithQuickReplyResponse: Conversation not found in instanceKeyCache, ignore it. InstanceKey {0}.",u);return null}var f=this.cB(u);if(f<0||f>=this.by.x.length){_j.e.a(this.bC(),"UpdateTableWithQuickReplyResponse: Conversation not found in table, ignore it. InstanceKey: {0}.",u);return null}var r=this.by.x[f];var e=r.h();this.bQ(r,n);if(i){r.bm(_a.d.b(n.LastDeliveryTime));this.by.C(f,0,r,4)}else r.bm(e);this.cQ[u]=!0;return r},hv:function(){if(this.bI){_j.e.a(this.bC(),"ResetOutstandingPostsCount:: Table already disposed, ignore call. Table Key:{0}.",this.bB.a());return}_j.e.a(this.bC(),"ResetOutstandingPostsCount:: Reset count and process pending notifications for table Key:{0}.",this.bB.a());this.eP()},ho:function(){this.cF++;this.ee.a()},hh:function(){if(!(this.cF<=0)){if(this.cF===1){this.eP();return}this.cF--}},eP:function(){this.cF=0;this.ee.b();this.ht()},hx:function(){var n=this.bB.n;if(n&&n.isMember&&!_mgn.d.a().a(n.a())){this.ex.a(_mgn.f,new _mgn.f(n.bD.SmtpAddress,n.bD.DisplayName,4));n.j=n.unseenData.a();var t;t=new _xh.H(n.bD.SmtpAddress,_a.d.get_utcNow(),this.bZ);_a.g.a.a(t)}},hj:function(){return!!this.bZ&&this.bZ.a().id().Enabled},hi:function(){return!!this.bZ&&this.bZ.a().gG().Enabled},hk:function(){return!!this.bZ&&this.bZ.a().bu().Enabled},ce:function(n,t,i,r,u,f){var s=t.L===700;var h=t.bs;if(this.hk()&&!s&&!h){for(var e=0;e<n.length;e++){var o=this.bG(n[e]);if(this.hn(o))break}if(e&&e!==n.length)while(n.length>e)Array.removeAt(n,e)}_h.r.prototype.ce.call(this,n,t,i,r,u,f)},hn:function(n){var t=this.bB.n;return n.h().p().b(t.p().p())<=0},o:function(n,t,i){if(t===700||t===200){this.hq(n,t,i);return}_lm.e.prototype.o.call(this,n,t,i)},hq:function(n,t,i){var r=n;r.b>this.cZ()&&(r.b=this.cZ());this.dB(r,t,i)}};_xc.l=function(n,t,i,r,u,f){_xc.l.initializeBase(this,[n,t,"All",i,null,null,-1]);this.j=r;this.o=u;this.n=f};_xc.l.prototype={j:!1,o:null,n:null,e:function(){var n=null;if(this.h)n=[new _h.dx(this)];else{var t=new _xc.o(this,!0,this.q(),this.k,this.o);n=[t]}return n}};_xc.b=function(){};_xc.b.B=function(n,t,i,r,u,f){if(_j.h.a(n)){_j.e.c(_a.a.w,"Internet message id can't be null");return null}var o=_xc.b.d+"_"+n;var e=_a.n.b(_a.a.w,_xc.b.d,!0,null,o);if(e){_xc.b.g.c(n);e.n(t?_xc.b.k:_xc.b.h);e.n(i?_xc.b.j:_xc.b.i);r&&e.n(_xc.b.x);u&&e.n(_xc.b.A);f&&e.n(_xc.b.m)}return e};_xc.b.f=function(n,t,i){if(_j.h.a(n)){_j.e.c(_a.a.w,"Internet message id can't be null");return}var f=_xc.b.d+"_"+n;var r=_a.n.c(f);if(r){r.l=t;if(!_j.h.a(i)){var u=new _a.l;u.b(_xc.b.w,i);r.j=u.toString()}}};_xc.b.c=function(n,t,i,r){var f=_xc.b.d+"_"+t;var u=_a.n.c(f);if(u){i&&u.n(_xc.b.C);switch(n){case 0:u.k=null;break;case 1:u.k=r;break;case 2:u.k=_xc.b.y;break;case 3:u.k=_xc.b.z;break;case 4:u.k=_a.c.e;break;default:throw Error.argument("endScenario","Unsupported PostCtqEndScenario type.");}_xc.b.g.n(t);_a.n.a(f)}};_xc.b.l=function(){for(var t=_xc.b.g.i(),n=0;n<t.length;n++)_xc.b.c(4,t[n],!1,null)};_xc.b.e=function(n,t){return _a.n.b(n,t,!0)};_xc.b.D=function(n,t,i){n.j=t;n.q=i;_a.c.a(n)};_xc.b.b=function(n,t,i,r,u){var f=_a.n.c(n);if(f){f.k=t;f.l=i;f.j=r;f.q=u;_a.n.a(n)}};_xc.b.a=function(n,t,i){var c=_xc.b.n;if(n){var h=-1;var o=-1;n.O()&&n.O().bD.Value&&(h=n.O().bD.Value.length);n.bD.Subject&&(o=n.bD.Subject.length);var f=-1;var l=-1;if(n.be()&&n.be().b()>=0){var s=0;f=n.be().b();for(var e=0;e<f;e++)s+=n.be().a(e).b();l=s/1024>>0}var u=-1;if(n.n()||n.p()||n.z()){u=0;n.n()&&(u+=n.n().b());n.p()&&(u+=n.p().b());n.z()&&(u+=n.z().b())}var r=new _a.l;r.a(_xc.b.r,h);r.a(_xc.b.v,o);r.a(_xc.b.o,100);r.a(_xc.b.p,f);r.a(_xc.b.q,l);r.a(_xc.b.s,u);r.c(_xc.b.t,t);r.c(_xc.b.u,i);c=r.toString()}return c};_xc.o=function(n,t,i,r,u){_xc.o.initializeBase(this,[n,t,i,r,null,-1,u,null,null])};_xc.o.prototype={e:function(){return"GroupRowNotificationStrategy"},f:function(n,t){if(t.bI){_j.e.a(t.bC(),"Abandoning row notification due to associated table [{0}] being disposed.",t.bB.a());return}var i=t;i.bB.j?i.eb(n):_h.w.prototype.f.call(this,n,t)}};_xc.e=function(n,t,i){this.f=n;this.b=t;this.a=i};_xc.e.b=function(n){var o=null;if(!_j.h.a(n)){var t;n=n.replace(_xc.e.d,"");var f,e;if((e=_a.z.a(n,f={val:t}),t=f.val,e)&&!_j.h.a(t)){var i=t.split("\n");var u=_xc.e.f(i);if(u<i.length){var r=i[u].trim();o=r.length<=100?r:r.substring(0,100)}}}return o};_xc.e.a=function(n,t,i,r,u){_xc.e.e(function(i){i.hr(n,t,r,u)},i)};_xc.e.c=function(n){_xc.e.e(function(n){n.hs()},n)};_xc.e.e=function(n,t){var u=_h.g.a().a(t);if(u)for(var f=u,e=f.length,i=0;i<e;++i){var r=f[i];_xc.h.isInstanceOfType(r)&&n(r)}};_xc.e.f=function(n){for(var t=0;t<n.length;){if(n[t].trim().length)break;t++}return t};_xc.e.prototype={f:null,a:null,b:!1,c:function(n){var t=new _g.M;var i=n.O().bD.Value;this.b&&!_j.h.b(n.bD.Subject)&&(i=n.bD.Subject);t.Subject=_xc.e.b(i);t.Body=new _g.s("HTML",n.O().bD.Value);t.ToRecipients=_db.e.a(n.n());t.From=n.bD.From;if(this.a){this.a.d()&&(t.AtAllMention=n.bD.AtAllMention);this.a.c()&&n.cu()&&(t.MentionsEx=_mco.f.a(n.cu(),n.bD.From));this.a.e()&&n.cC()&&(t.Hashtags=n.cC().e())}!n.bD.ItemId&&n.bD.InternetMessageId&&(t.InternetMessageId=n.bD.InternetMessageId);t.ItemId=n.bD.ItemId;_db.e.b(n,t);return t},d:function(n,t,i,r){var u=new _g.bs;u.Subject=t.bD.Subject;u.NewBodyContent=new _g.s("HTML",n.O().a()==="HTML"?n.O().bD.Value:_a.z.b(n.O().bD.Value,!0,!0));var e=0;var f=0;if(n.n()){u.ToRecipients=n.n().e();e=n.n().b()}if(n.p()){u.CcRecipients=n.p().e();f=n.p().b()}u.From=n.bD.From;if(this.a){this.a.d()&&(u.AtAllMention=n.bD.AtAllMention);this.a.c()&&n.cu()&&(u.MentionsEx=_mco.f.a(n.cu(),n.bD.From));this.a.e()&&n.cC()&&(u.Hashtags=n.cC().e())}n.bD.InternetMessageId&&(u.InternetMessageId=n.bD.InternetMessageId);i&&(u.UpdateResponseItemId=i);u.ReferenceItemId=_g.e.a(t.bD.ItemId);u.IsSpecificMessageReply=r;_db.e.b(n,u);return u},e:function(n){if(!n||!n.f())return null;for(var t=0;t<n.f().b();t++){var i=n.f().a(t);if(i.toLocaleLowerCase().startsWith("ipm.note.connectormessage"))return i}return null}};_xc.f=function(n,t,i,r,u,f,e,o,s){_xc.f.initializeBase(this);this.g=n;this.e=r;this.t=_xc.f.b(r,u);this.q=_xc.f.a;this.j=e;this.k=new _xc.e(f,s,o);this.F=t;this.v=i};_xc.f.b=function(n,t){var i=_ff.e.a(_h.b.d());i.ConversationShapeName=t;i.ConversationFolderId=_g.m.c(n);return i};_xc.f.c=function(n,t,i){var r=null;if(n.Items&&n.Items.length>0){r=n.Items[0];if(t.a()==="HTML")r.UniqueBody=new _g.s("HTML",t.bD.Value);else throw Error.notImplemented("Plaintext body is not currently supported in quick compose.");}return r};_xc.f.prototype={e:null,t:null,q:"Folder",g:null,F:0,v:0,k:null,bk:null,j:!1,s:function(){return"QuickCompose"},p:function(n){n.h(this.e.a.Mailbox.EmailAddress,this.e.b)},K:function(n){this.bu();if(this.j){var r=this.bs();var i=this.br();n.cG(r,i,this.J,this.H)}else{var u=this.bt();var t=this.bp();t.explicitLogonUser=this.e.a.Mailbox.EmailAddress;n.cH(u,t,this.J,this.H)}},cI:function(n){_j.e.a(_a.a.z,"PostModernGroupItemAction.ProcessResponseMessage called");var t=_xc.f.c(n,this.g.O(),this.e);t&&(this.bk=t.ItemId);this.u(t);this.bm()},ba:function(n){_h.fl.prototype.ba.call(this,n);this.u(null);this.bl()},bm:function(){var n=this.O();this.bo(n);_xc.b.b("Group_Conversation_QuickCompose",null,n,_xc.b.a(this.g,!1,!1),this.e.a.Mailbox.EmailAddress)},bl:function(){var t=this.O();var n=this.P();this.bn(t,n);_xc.b.b("Group_Conversation_QuickCompose",n,t,_xc.b.a(this.g,!1,!1),this.e.a.Mailbox.EmailAddress)},u:function(n){_xc.e.a(n,!1,this.e,!1,!1)},bo:function(n){this.j&&_xc.b.f(this.g.bD.InternetMessageId,n,null)},bn:function(n,t){if(this.j){_xc.b.f(this.g.bD.InternetMessageId,n,null);_xc.b.c(1,this.g.bD.InternetMessageId,!1,t)}},bt:function(){var t=new _gg.eQ;this.bh(t);var n=new _gg.jm(this.M());n.Body=t;return n},bs:function(){var t=new _gg.eP;this.bh(t);var n=new _gg.jl(this.M());n.Body=t;return n},bi:function(){return[this.k.c(this.g)]},bh:function(n){n.ModernGroupEmailAddress=this.e.a.Mailbox;n.Items=this.bi();n.ShapeName=this.q;n.ItemShape=this.t;n.ClientSupportsIrm=!0;n.UnpromotedInlineImageCount=this.F;n.PromoteEmojiContentToInlineAttachmentsCount=this.v},bp:function(){var n=new _gg.yn(this.L);n.actionName=this.s();return n},br:function(){var n=new _gg.ym(this.L);n.actionName=this.s();return n},bu:function(){_xc.e.c(this.e)}};_xc.p=function(n,t,i){this.e=n;this.d=t;this.f=i};_xc.p.prototype={e:null,d:null,f:0,c:null,b:function(){if(this.c){_j.m.a().b(this.c);this.c=null}},a:function(){this.b();this.c=_j.m.a().a(_a.a.dt,this.e,this.d,this.f)}};_xc.q=function(){};_xc.q.prototype={a:function(n,t,i){return new _xc.p(n,t,i)}};_xc.r=function(n,t){this.a=n;this.b=t};_xc.r.prototype={a:null,b:null,c:function(){return!!this.b}};_xc.a=function(){};_xc.a.$$cctor=function(){_xc.a._I()};_xc.a.w=function(){var n=window.document.createElement("DIV");n.innerHTML="<div>  <span class='_xc_3 _xc_4 ms-font-l ms-font-color-themePrimary'></span> <span class='_xc_6'></span> </div><div> <span class='_xc_2 ms-font-color-neutralSecondary ms-font-color-neutralPrimary ms-font-weight-semilight'></span> <button type='button' class='_xc_5 ms-font-weight-regular'></button> </div><div> <span class='_xc_7 ms-font-weight-semilight ms-font-color-neutralPrimary ms-font-m'></span> <span class='_xc_7 ms-font-weight-semilight ms-font-color-themePrimary ms-font-m'></span> </div><div> <div CssClass=\"suggestionDiv\"> <button type='button'></button> </div> <button type='button' class='_xc_9'></button> </div><div> <div> </div> </div><div> <div></div> </div><div>  <div class='_xc_b'> <div></div> </div>  <div class='_xc_d'></div> </div><div> <div class='_xc_a'> <div class='_xc_c'> <div></div> </div> </div> </div><div> <div class='_xc_e _xc_f'>  <div> <div></div> </div> <div></div> <div> </div> </div> </div>";_j.i.a().appendChild(n);return n};_xc.a.d=function(n){return n.m()};_xc.a.i=function(n){return n.c()};_xc.a.M=function(n){return n.w()};_xc.a.q=function(n){return n.b()};_xc.a.F=function(n){return n.q()};_xc.a.B=function(n){return n.k()};_xc.a.bk=function(n){return n.t()};_xc.a.bl=function(n){return n.k};_xc.a.bj=function(n){return n.i};_xc.a.bh=function(n){return n.g};_xc.a.bi=function(n){return n.q()};_xc.a.u=function(n){return n.p()};_xc.a.c=function(n){return n.a};_xc.a.r=function(n){return n.a};_xc.a.K=function(n){return n.G};_xc.a.N=function(n){return n.b};_xc.a.V=function(n){return n.c};_xc.a.J=function(n){return n.f};_xc.a.U=function(n){return n.e};_xc.a.t=function(n){return n.g};_xc.a.P=function(n){return n.c};_xc.a.s=function(n){return n.d};_xc.a.S=function(n){return n.d};_xc.a.j=function(n){return n.a};_xc.a.R=function(n){return n.h()};_xc.a.Q=function(n){return n.g};_xc.a.bg=function(n){return n.k()};_xc.a.bf=function(n){return _xh.c.isInstanceOfType(n)?n.n():null};_xc.a.be=function(n){return n.h};_xc.a.p=function(n){return n.b()};_xc.a.g=function(n,t){n.a(t)};_xc.a.E=function(n,t){n.a(t)};_xc.a.l=function(n,t){n.K(t)};_xc.a.o=function(n,t){n.bl(t)};_xc.a.A=function(n,t){n.j(t)};_xc.a.n=function(n,t){n.l(t)};_xc.a.x=function(n,t){n.Q(t)};_xc.a.D=function(n,t){n.c(t)};_xc.a.G=function(n,t){n.m(t)};_xc.a.C=function(n,t){n.j(t)};_xc.a.m=function(n,t){n.T(t)};_xc.a.y=function(n,t){n.m(t)};_xc.a.z=function(n,t){n.s(t)};_xc.a.W=function(n,t){n.f(t)};_xc.a.O=function(n,t){n.b=t};_xc.a.Y=function(n,t){n.g(t)};_xc.a.L=function(n,t){n.bg(t)};_xc.a.X=function(n,t){n.o(t)};_xc.a.h=function(n,t){n.ba(t)};_xc.a.bb=function(n,t){n.e(t)};_xc.a.T=function(n,t){n.F(t)};_xc.a.bd=function(n,t){n.l(t)};_xc.a.bc=function(n,t){n.b(t)};_xc.a.I=function(n,t){n.j(t)};_xc.a.H=function(n,t){n.bT(t)};_xc.a.ba=function(n,t){n.b(t)};_xc.a.Z=function(n,t){n.c(t)};_xc.a.k=function(){_xc.a.e||(_xc.a.e=new _fc.k);return _xc.a.e};_xc.a.v=function(){_xc.a.f||(_xc.a.f=new _fc.l);return _xc.a.f};_xc.a._I=function(){var e="GroupSearchResultsHeader._tid1";new _j.d(e,function(){_xc.a.a[e]===undefined&&(_xc.a.a[e]=[[[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Text",null,_xc.a.g,1,null,null,null]],[[-1,4,null,null,null,"Id",null,_xc.a.E,0,null,null,null,_n.b.co()]]]);var n=_xc.a.b.childNodes[0].cloneNode(!0);var i=new _fc.d(n.children[1],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",IGroupSearchViewModel,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_xc.a.a);var f="GroupSearchResultsHeader";new _j.d(f,function(){_xc.a.a[f]===undefined&&(_xc.a.a[f]=[[[-1,4,null,null,null,"Text",null,_xc.a.g,0,null,null,null,_mgs.X.Cj]],[[-1,4,null,null,null,"ImageId",null,_xc.a.n,0,null,null,null,_n.b.co()],[-1,0,["ShouldShowSortByMenuOnHeader"],[_xc.a.M],null,"IsHidden",null,_xc.a.l,1,_xc.a.k(),null,!0],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Title",null,_xc.a.o,1,null,null,null],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"Text",null,_xc.a.A,1,null,null,null],[-1,0,["SearchResultsSortByManager","SearchResultsSortOptionString"],[_xc.a.d,_xc.a.i],null,"AriaLabel",null,_xc.a.x,1,null,null,null]]]);var i=_xc.a.b.childNodes[1].cloneNode(!0);var t=new _fc.b(i.children[1]);var n=new _fce.g(_j.b.Instance.a(_fc.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));n.U(_j.f.a(["SearchResultsSortByManager","SearchResultsSortByContextMenu"],[_xc.a.d,_xc.a.q],null,"MenuDataContext",null,_xc.a.D,1)).U(_j.f.a(["SearchResultsSortByManager","SearchResultsSortByContextMenu","IsShown"],[_xc.a.d,_xc.a.q,_xc.a.F],_xc.a.G,"IsShown",_xc.a.B,_xc.a.C,2,null,null,!1));n.b=1;n.a=3;n.g="headerMenuDropShadow ms-border-color-themeLight";t.C([n]);t.y("GroupSearchResultsHeader._tid1");var r=new _fc.a(i.children[0]);return new _j.a(i,[r,t])},"",IGroupSearchViewModel,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_xc.a.a);var s="SuggestGroupsSearchView._tid2";new _j.d(s,function(){_xc.a.a[s]===undefined&&(_xc.a.a[s]=[[[-1,0,["SuggestGroupSearchPrefechedResultsText"],[_xc.a.bk],null,"Text",null,_xc.a.g,1,null,null,null]],[[-1,0,["SuggestGroupSearchSeeResultsText"],[_xc.a.bl],null,"Text",null,_xc.a.g,1,null,null,null]]]);var n=_xc.a.b.childNodes[2].cloneNode(!0);var i=new _fc.a(n.children[1]);var t=new _fc.a(n.children[0]);return new _j.a(n,[t,i])},"",_xc.k,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_xc.a.a);var o="SuggestGroupsSearchView";new _j.d(o,function(){_xc.a.a[o]===undefined&&(_xc.a.a[o]=[[[-1,0,["GoToSuggestedGroupSearchCommand"],[_xc.a.bj],null,"ClickCommand",null,_xc.a.m,0,null,null,null]],[[-1,4,null,null,null,"Title",null,_xc.a.o,0,null,null,null,_u.R.Pl],[-1,0,["CloseCommand"],[_xc.a.bh],null,"ClickCommand",null,_xc.a.m,1,null,null,null],[-1,0,["CloseImage"],[_xc.a.bi],null,"ImageId",null,_xc.a.n,0,null,null,null],[-1,0,["CloseHoverImage"],[_xc.a.u],null,"HoveredImageId",null,_xc.a.y,0,null,null,null],[-1,0,["CloseHoverImage"],[_xc.a.u],null,"PressedImageId",null,_xc.a.z,0,null,null,null]]]);var n=_xc.a.b.childNodes[3].cloneNode(!0);var i=new _fc.b(n.children[1]);var t=new _fc.b(_j.a.a(n,[0,0]));t.y("SuggestGroupsSearchView._tid2");return new _j.a(n,[t,i])},"",_xc.k,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_xc.a.a);var u="FilesModernNavigationPaneView._tid3._tid4";new _j.d(u,function(){_xc.a.a[u]===undefined&&(_xc.a.a[u]=[[[-1,0,["MailNavigationViewModel","FolderForest","FirstLevelNavigationFolderTrees"],[_xc.a.c,_xc.a.r,_xc.a.K],null,"DataSource",null,_xc.a.W,1,null,null,null],[-1,0,["FirstLevelNavigationSelectedTree"],[_xc.a.N],_xc.a.O,"SelectedTreeData",_xc.a.V,_xc.a.Y,2,null,null,null],[-1,0,["MailNavigationViewModel","FolderForest","ActionTargetFolder"],[_xc.a.c,_xc.a.r,_xc.a.J],_xc.a.L,"DropTargetTreeNodeData",_xc.a.U,_xc.a.X,2,null,null,null]]]);var t=_xc.a.b.childNodes[4].cloneNode(!0);var n=new _n.C(t.children[0],_j.b.Instance.a(_n.d));return new _j.a(t,[n]).b(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_xc.a.a);var t="FilesModernNavigationPaneView._tid3._tid5";new _j.d(t,function(){_xc.a.a[t]===undefined&&(_xc.a.a[t]=[[[-1,0,["GroupsNavigationViewModel"],[_xc.a.t],null,"DataContext",null,_xc.a.h,1,null,null,null]]]);var i=_xc.a.b.childNodes[5].cloneNode(!0);var n=new _j.c(i.children[0]);n.y("CondensedGroupsNavigationView");return new _j.a(i,[n]).b(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_xc.a.a);var n="FilesModernNavigationPaneView._tid3";new _j.d(n,function(){_xc.a.a[n]===undefined&&(_xc.a.a[n]=[[[-1,5,["MailNavigationViewModel","IsExpanded"],[_xc.a.c,_xc.a.P],null,"hidden",null,null,0,_xc.a.k(),null,null]],[[-1,0,["GroupsNavigationViewModel"],[_xc.a.t],null,"IsHidden",null,_xc.a.l,1,_xc.a.v(),null,!0]]]);var r=_xc.a.b.childNodes[6].cloneNode(!0);var i=new _j.c(r.children[1]);i.y("FilesModernNavigationPaneView._tid3._tid5");var t=new _j.c(_j.a.a(r,[0,0]));t.y("FilesModernNavigationPaneView._tid3._tid4");return new _j.a(r,[t,i]).l({FoldersControl:t,GroupsControl:i})},"",_y.s,_n.G,function(n){return new _n.G(n)},!1,!0,!1,0,_xc.a.a);var r="FilesModernNavigationPaneView";new _j.d(r,function(){_xc.a.a[r]===undefined&&(_xc.a.a[r]=[null,null,[[-1,0,["MailNavigationViewModel","Width"],[_xc.a.c,_xc.a.s],null,"LeftNavWidth",null,_xc.a.bb,1,null,null,0],[-1,2,["MailNavigationViewModel","WidthOfScrollRegion"],[_xc.a.c,_xc.a.S],null,_fce.c.b,null,null,1,null,null,null]]]);var t=_xc.a.b.childNodes[7].cloneNode(!0);var n=new _n.G(_j.a.a(t,[0,0,0]));n.eC(_fce.c.a,3);n.L(!0);n.y("FilesModernNavigationPaneView._tid3");n.z.parentNode.removeChild(n.z);var i=new _fce.c(_j.a.a(t,[0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));i.b(1);var u=new _fce.f(t.children[0],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));u.L(!0);i.a.a(n);return new _j.a(t,[u,i,n]).b(n)},"",_y.s,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_xc.a.a);var i="GroupFilesModuleView";new _j.d(i,function(){_xc.a.a[i]===undefined&&(_xc.a.a[i]=[null,[[-1,2,["MailModernNavigationPane","MailNavigationViewModel","Width"],[_xc.a.j,_xc.a.c,_xc.a.s],_xc.a.T,_fce.c.b,null,null,2,null,null,null],[-1,2,["MailModernNavigationPane","MailNavigationViewModel","MinWidth"],[_xc.a.j,_xc.a.c,_xc.a.R],null,_fce.c.d,null,null,1,null,null,null],[-1,2,["MailModernNavigationPane","MailNavigationViewModel","MaxWidth"],[_xc.a.j,_xc.a.c,_xc.a.Q],null,_fce.c.e,null,null,1,null,null,null]],[[-1,4,null,null,null,"HeaderRegionPriority",null,_xc.a.bd,0,null,null,0,351],[-1,4,null,null,null,"ContentRegionPriority",null,_xc.a.bc,0,null,null,0,352],[-1,0,["MailModernNavigationPane"],[_xc.a.j],null,"DataContext",null,_xc.a.h,1,null,null,null]],[[-1,0,["GroupManagementHeaderViewModel"],[_xc.a.bg],null,"DataContext",null,_xc.a.h,1,null,null,null],[0,0,["IsGroupHeaderEnabled"],[_xc.a.bf],null,"IsHidden",null,_xc.a.l,1,_xc.a.k(),null,!0]],[[-1,4,null,null,null,"TextSelectionType",null,_xc.a.H,0,null,null,0,2],[-1,0,["FilesContentConductor"],[_xc.a.be],null,"DataContext",null,_xc.a.h,1,null,null,null],[0,0,["ActiveNavigationStack"],[_xc.a.p],null,"ActiveNavigationStack",null,_xc.a.ba,1,null,null,null],[0,0,["ActiveNavigationStack"],[_xc.a.p],null,"ActiveItems",null,_xc.a.Z,1,null,null,null]]]);var r=_xc.a.b.childNodes[8].cloneNode(!0);var u=new _n.g(_j.a.a(r,[0,2]),_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));u.eC(_fce.c.a,4);u.F(39);u.z.parentNode.removeChild(u.z);var n=new _j.c(_j.a.a(r,[0,1]));n.eC(_fce.c.a,0);n.eC(_fce.c.b,100);n.y("UnifiedGroupHeaderView");var e=new _b.m(_j.b.Instance.a(_b.h),_j.b.Instance.a(_j.o));e.U(_j.f.b(353,null,null,null,"Priority",null,_xc.a.I,0,null,null,0));e.i(!0);n.C([e]);n.z.parentNode.removeChild(n.z);var o=new _n.q(_j.a.a(r,[0,0,0]),_j.b.Instance.a(_a.f),_j.b.Instance.a(_j.j),_j.b.Instance.a(_a.f),_j.b.Instance.a(_a.x),_j.b.Instance.a(_g.h));o.a(!1);o.c(!0);var t=new _j.i(_j.a.a(r,[0,0]));t.eC(_fce.c.a,3);t.eC(_fce.c.c,!0);t.z.parentNode.removeChild(t.z);var f=new _fce.c(r.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));f.b(2);f.a.a(t);f.a.a(n);f.a.a(u);return new _j.a(r,[f,t,o,n,u])},"",_xc.j,_j.c,function(n){return new _j.c(n)},!0,!1,!1,0,_xc.a.a)};_xc.i.registerClass("_xc.i",_h.bM);ModernGroupsCoreComponent.registerClass("ModernGroupsCoreComponent",null,_a.iF,_j.cd);_xc.t.registerClass("_xc.t",_y.hR);_xc.d.registerClass("_xc.d",_lv.h,_xs.s,_y.id,_y.bI,_j.br,Sys.IDisposable,_y.iR,_y.z,_bc.s,_a.jq,_y.el,_xc.w);_xc.c.registerClass("_xc.c",_lv.d);_xc.k.registerClass("_xc.k",_a.bt);_xc.j.registerClass("_xc.j",_mgn.bv,IGroupFilesModuleViewModel);_xc.v.registerClass("_xc.v",_db.b);_xc.h.registerClass("_xc.h",_lm.b,_rps.j,_h.C,_h.E,_h.fe,_j.br,Sys.IDisposable);_xc.n.registerClass("_xc.n",_xc.h);_xc.l.registerClass("_xc.l",_lm.f,IGroupConversationTableQuery);_xc.o.registerClass("_xc.o",_h.w);_xc.f.registerClass("_xc.f",_h.cZ.$$(_gg.yo,_g.dx),_h.df);_xc.q.registerClass("_xc.q",null,_h.cI);_xc.i.a="ModernGroup";_xc.i.b="SearchModernGroup";ModernGroupsCoreComponent.$$cctor();_xc.d.a=new _h.o("ConversationLastDeliveryTime","Descending");_xc.d.c=new _a.D("GroupListView");_xc.c.a.a=null;_xc.j.a=_a.a.M;_xc.g.b=new _a.D("Missed");_xc.g.c=new _a.D("UnseenTimeout");_xc.g.a=new _h.o("ConversationLastDeliveryTime","Descending");_xc.b.h=new _a.D("Comp");_xc.b.k=new _a.D("Reply");_xc.b.i=new _a.D("PGI");_xc.b.j=new _a.D("PUGI");_xc.b.C=new _a.D("SyncD");_xc.b.A=new _a.D("USave");_xc.b.m=new _a.D("ASave");_xc.b.x=new _a.D("Att");_xc.b.g=new _j.q;_xc.b.y="NotificationTimeout";_xc.b.z="Refresh";_xc.b.d="Group_Conversation_E2E_Post";_xc.b.n="inv";_xc.b.r="bl";_xc.b.v="sl";_xc.b.o="ms";_xc.b.p="ac";_xc.b.q="as";_xc.b.s="ec";_xc.b.t="ir";_xc.b.u="sdp";_xc.b.w="sdcorrid";_xc.e.d=new RegExp("<span(?:.*?)imagepromote=(?:.*?)<\\/span>","gi");_xc.f.a="QuickComposeItemPart";_xc.a.b=_xc.a.w();_xc.a.e=null;_xc.a.f=null;_xc.a.a={};_xc.a.$$cctor();
window.scriptsLoaded['microsoft.owa.moderngroupscore.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.moderngroupscore.js'] = (new Date()).getTime(); } catch(e) { window.owaLastErrorReported = e; throw e; }
